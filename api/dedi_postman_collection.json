{
	"info": {
		"_postman_id": "ac219a4d-3ecc-4427-ab17-1ce452917f75",
		"name": "DeDi API Collection",
		"description": "Complete DeDi API collection with dual authentication support (Cookie + API Key).",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "27224718"
	},
	"item": [
		{
			"name": "query",
			"item": [
				{
					"name": "namespace",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"type": "text/javascript",
								"exec": [
									"// ‚úÖ Authentication is handled automatically by the global collection script"
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200 or error\", function () {",
									"  pm.expect([200, 400, 401, 404, 500]).to.include(pm.response.code);",
									"});",
									"if (pm.response.code === 200) {",
									"  const res = pm.response.json();",
									"  pm.expect(res).to.have.property(\"message\");",
									"  pm.expect(res).to.have.property(\"data\");",
									"  pm.expect(res.data).to.have.property(\"registries\");",
									"  pm.environment.set(\"namespace_id\", res.data.namespace_id);",
									"  pm.environment.set(\"total_registries\", res.data.total_registries);",
									"}"
								]
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{url}}/dedi/query/{{namespace}}",
							"host": [
								"{{url}}"
							],
							"path": [
								"dedi",
								"query",
								"{{namespace}}"
							],
							"query": [
								{
									"key": "from",
									"value": "",
									"disabled": true
								},
								{
									"key": "to",
									"value": "",
									"disabled": true
								},
								{
									"key": "status",
									"value": "",
									"disabled": true
								},
								{
									"key": "name",
									"value": "",
									"disabled": true
								},
								{
									"key": "sort",
									"value": "",
									"disabled": true
								},
								{
									"key": "page",
									"value": "",
									"disabled": true
								},
								{
									"key": "page_size",
									"value": "",
									"disabled": true
								},
								{
									"key": "as_on",
									"value": "",
									"disabled": true
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "registry",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"type": "text/javascript",
								"exec": [
									"// ‚úÖ Authentication is handled automatically by the global collection script"
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200 or error\", function () {",
									"  pm.expect([200, 400, 401, 404, 500]).to.include(pm.response.code);",
									"});",
									"if (pm.response.code === 200) {",
									"  const res = pm.response.json();",
									"  pm.expect(res).to.have.property(\"message\");",
									"  pm.expect(res).to.have.property(\"data\");",
									"  pm.expect(res.data).to.have.property(\"records\");",
									"  pm.environment.set(\"registry_id\", res.data.registry_id);",
									"  pm.environment.set(\"total_records\", res.data.total_records);",
									"}"
								]
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{url}}/dedi/query/{{namespace}}/{{registry_name}}",
							"host": [
								"{{url}}"
							],
							"path": [
								"dedi",
								"query",
								"{{namespace}}",
								"{{registry_name}}"
							],
							"query": [
								{
									"key": "from",
									"value": "",
									"disabled": true
								},
								{
									"key": "to",
									"value": "",
									"disabled": true
								},
								{
									"key": "state",
									"value": "",
									"disabled": true
								},
								{
									"key": "name",
									"value": "",
									"disabled": true
								},
								{
									"key": "sort",
									"value": "",
									"disabled": true
								},
								{
									"key": "page",
									"value": "",
									"disabled": true
								},
								{
									"key": "page_size",
									"value": "",
									"disabled": true
								},
								{
									"key": "as_on",
									"value": "",
									"disabled": true
								}
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "lookup",
			"item": [
				{
					"name": "namespace",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"type": "text/javascript",
								"exec": [
									"// ‚úÖ Authentication is handled automatically by the global collection script"
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200 or error\", function () {",
									"  pm.expect([200, 400, 401, 404, 500]).to.include(pm.response.code);",
									"});",
									"if (pm.response.code === 200) {",
									"  const res = pm.response.json();",
									"  pm.expect(res).to.have.property(\"message\");",
									"  pm.expect(res).to.have.property(\"data\");",
									"}"
								]
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{url}}/dedi/lookup/{{namespace}}",
							"host": [
								"{{url}}"
							],
							"path": [
								"dedi",
								"lookup",
								"{{namespace}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "registry",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"type": "text/javascript",
								"exec": [
									"// ‚úÖ Authentication is handled automatically by the global collection script"
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200 or error\", function () {",
									"  pm.expect([200, 400, 401, 404, 500]).to.include(pm.response.code);",
									"});",
									"if (pm.response.code === 200) {",
									"  const res = pm.response.json();",
									"  pm.expect(res).to.have.property(\"message\");",
									"  pm.expect(res).to.have.property(\"data\");",
									"  pm.collectionVariables.set(\"registry_id\", res.data.registry_id);",
									"}"
								]
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{url}}/dedi/lookup/{{namespace}}/{{registry_name}}",
							"host": [
								"{{url}}"
							],
							"path": [
								"dedi",
								"lookup",
								"{{namespace}}",
								"{{registry_name}}"
							],
							"query": [
								{
									"key": "version_id",
									"value": "0x06b29cd2b441cc92dc38b6d579a3eb62ad4afd26256678bc2461e88f9ec659f5",
									"description": "Optional: Specific version ID for historical lookup",
									"disabled": true
								},
								{
									"key": "as_on",
									"value": "2024-01-01T00:00:00Z",
									"description": "Optional: Point-in-time query (ISO 8601 format)",
									"disabled": true
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "record",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"type": "text/javascript",
								"exec": [
									"// ‚úÖ Authentication is handled automatically by the global collection script"
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200 or error\", function () {",
									"  pm.expect([200, 400, 401, 404, 500]).to.include(pm.response.code);",
									"});",
									"if (pm.response.code === 200) {",
									"  const res = pm.response.json();",
									"  pm.expect(res).to.have.property(\"message\");",
									"  pm.expect(res).to.have.property(\"data\");",
									"  pm.collectionVariables.set(\"record_id\", res.data.record_id);",
									"}"
								]
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{url}}/dedi/lookup/{{namespace}}/{{registry_name}}/{{record_name}}",
							"host": [
								"{{url}}"
							],
							"path": [
								"dedi",
								"lookup",
								"{{namespace}}",
								"{{registry_name}}",
								"{{record_name}}"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "version",
			"item": [
				{
					"name": "namespace version list",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"type": "text/javascript",
								"exec": [
									"// Ensure auth_cookie is set",
									"if (!pm.variables.get('auth_cookie')) {",
									"  pm.variables.set('auth_cookie', '');",
									"}",
									"// Ensure namespace variable is set",
									"if (!pm.variables.get('namespace')) {",
									"  pm.variables.set('namespace', '');",
									"}",
									"// Set Cookie header for authentication",
									"pm.request.headers.upsert({key: 'Cookie', value: 'token=' + pm.variables.get('auth_cookie')});"
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('Status code is 200', function () {",
									"  pm.response.to.have.status(200);",
									"});",
									"pm.test('Response has message and data', function () {",
									"  var json = pm.response.json();",
									"  pm.expect(json).to.have.property('message');",
									"  pm.expect(json).to.have.property('data');",
									"  pm.expect(json.data).to.have.property('versions');",
									"  pm.expect(json.data.versions).to.be.an('array');",
									"});",
									"// Optionally extract total_versions for chaining",
									"if (pm.response.json().data && pm.response.json().data.total_versions !== undefined) {",
									"  pm.variables.set('namespace_total_versions', pm.response.json().data.total_versions);",
									"}"
								]
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{url}}/dedi/versions/{{namespace}}",
							"host": [
								"{{url}}"
							],
							"path": [
								"dedi",
								"versions",
								"{{namespace}}"
							]
						},
						"description": "Lists all versions for the given namespace. Requires authentication via cookie. Set 'auth_cookie' variable with your session token."
					},
					"response": []
				},
				{
					"name": "registry version list",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"type": "text/javascript",
								"exec": [
									"// Ensure auth_cookie is set",
									"if (!pm.variables.get('auth_cookie')) {",
									"  pm.variables.set('auth_cookie', '');",
									"}",
									"// Ensure namespace and registry_name variables are set",
									"if (!pm.variables.get('namespace')) {",
									"  pm.variables.set('namespace', '');",
									"}",
									"if (!pm.variables.get('registry_name')) {",
									"  pm.variables.set('registry_name', '');",
									"}",
									"// Set Cookie header for authentication",
									"pm.request.headers.upsert({key: 'Cookie', value: 'token=' + pm.variables.get('auth_cookie')});"
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('Status code is 200', function () {",
									"  pm.response.to.have.status(200);",
									"});",
									"pm.test('Response has message and data', function () {",
									"  var json = pm.response.json();",
									"  pm.expect(json).to.have.property('message');",
									"  pm.expect(json).to.have.property('data');",
									"  pm.expect(json.data).to.have.property('versions');",
									"  pm.expect(json.data.versions).to.be.an('array');",
									"});",
									"// Optionally extract total_versions for chaining",
									"if (pm.response.json().data && pm.response.json().data.total_versions !== undefined) {",
									"  pm.variables.set('registry_total_versions', pm.response.json().data.total_versions);",
									"}"
								]
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{url}}/dedi/versions/{{namespace}}/{{registry_name}}",
							"host": [
								"{{url}}"
							],
							"path": [
								"dedi",
								"versions",
								"{{namespace}}",
								"{{registry_name}}"
							]
						},
						"description": "Lists all versions for the given registry. Requires authentication via cookie. Set 'auth_cookie' variable with your session token."
					},
					"response": []
				},
				{
					"name": "record version list",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"type": "text/javascript",
								"exec": [
									"// Ensure auth_cookie is set",
									"if (!pm.variables.get('auth_cookie')) {",
									"  pm.variables.set('auth_cookie', '');",
									"}",
									"// Ensure namespace, registry_name, and record_name variables are set",
									"if (!pm.variables.get('namespace')) {",
									"  pm.variables.set('namespace', '');",
									"}",
									"if (!pm.variables.get('registry_name')) {",
									"  pm.variables.set('registry_name', '');",
									"}",
									"if (!pm.variables.get('record_name')) {",
									"  pm.variables.set('record_name', '');",
									"}",
									"// Set Cookie header for authentication",
									"pm.request.headers.upsert({key: 'Cookie', value: 'token=' + pm.variables.get('auth_cookie')});"
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('Status code is 200', function () {",
									"  pm.response.to.have.status(200);",
									"});",
									"pm.test('Response has message and data', function () {",
									"  var json = pm.response.json();",
									"  pm.expect(json).to.have.property('message');",
									"  pm.expect(json).to.have.property('data');",
									"  pm.expect(json.data).to.have.property('versions');",
									"  pm.expect(json.data.versions).to.be.an('array');",
									"});",
									"// Optionally extract total_versions for chaining",
									"if (pm.response.json().data && pm.response.json().data.total_versions !== undefined) {",
									"  pm.variables.set('record_total_versions', pm.response.json().data.total_versions);",
									"}"
								]
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{url}}/dedi/versions/{{namespace}}/{{registry_name}}/{{record_name}}",
							"host": [
								"{{url}}"
							],
							"path": [
								"dedi",
								"versions",
								"{{namespace}}",
								"{{registry_name}}",
								"{{record_name}}"
							]
						},
						"description": "Lists all versions for the given record. Requires authentication via cookie. Set 'auth_cookie' variable with your session token."
					},
					"response": []
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// üîê DeDi API Collection - Dual Authentication Handler",
					"// This script automatically handles both Cookie and API Key authentication",
					"",
					"const apiKey = pm.collectionVariables.get('api_key');",
					"const authCookie = pm.collectionVariables.get('auth_cookie');",
					"",
					"// Priority: API Key > Cookie",
					"if (apiKey && apiKey !== '' && !apiKey.includes('paste-your-api-key')) {",
					"  // Use API Key authentication (recommended for production)",
					"  pm.request.headers.upsert({",
					"    key: 'Authorization',",
					"    value: `Bearer ${apiKey}`",
					"  });",
					"  // Remove cookie header if present",
					"  pm.request.headers.remove('Cookie');",
					"} else if (authCookie && authCookie !== '' && !authCookie.includes('paste-your-token')) {",
					"  // Use Cookie authentication (for browser integration)",
					"  pm.request.headers.upsert({",
					"    key: 'Cookie',",
					"    value: `token=${authCookie}`",
					"  });",
					"  // Remove Authorization header if present",
					"  pm.request.headers.remove('Authorization');",
					"} else {",
					"  // No authentication configured - endpoints may fail if auth is required",
					"  pm.request.headers.remove('Authorization');",
					"  pm.request.headers.remove('Cookie');",
					"}"
				]
			}
		}
	],
	"variable": [
		{
			"key": "url",
			"value": "https://api.dedi.global",
			"type": "default",
			"description": "üåê DeDi API Base URL. Use 'https://api.dedi.global' for production or 'http://localhost:5200' for local development."
		},
		{
			"key": "user_email",
			"value": "testuser@yourdomain.com",
			"type": "string"
		},
		{
			"key": "user_name",
			"value": "TestUser",
			"type": "string"
		},
		{
			"key": "user_action",
			"value": "register",
			"type": "string"
		},
		{
			"key": "auth_cookie",
			"value": "",
			"type": "string",
			"description": "üç™ COOKIE AUTHENTICATION: After email verification, copy the 'token' cookie from browser DevTools ‚Üí Application ‚Üí Cookies and paste it here. This will be automatically used for ALL authenticated requests in the collection! You only need to set this ONCE per session."
		},
		{
			"key": "api_key",
			"value": "",
			"type": "string",
			"description": "üîë API KEY AUTHENTICATION: Use the 'get-api-key' endpoint to generate your API key, then paste it here. This is the recommended method for production integrations. All authenticated requests will automatically use Bearer token authentication."
		},
		{
			"key": "creator_id",
			"value": "",
			"type": "string"
		},
		{
			"key": "token",
			"value": "fetch from login",
			"type": "string"
		},
		{
			"key": "namespace",
			"value": "",
			"type": "string"
		},
		{
			"key": "namespace_name",
			"value": "",
			"type": "string"
		},
		{
			"key": "namespace_creator_id",
			"value": "",
			"type": "string"
		},
		{
			"key": "registry_name",
			"value": "",
			"type": "string"
		},
		{
			"key": "registry_description",
			"value": "Test registry description",
			"type": "string"
		},
		{
			"key": "registry_id",
			"value": "",
			"type": "string"
		},
		{
			"key": "registry_auth",
			"value": "",
			"type": "string"
		},
		{
			"key": "bulk_upload_jobId",
			"value": "",
			"type": "string"
		},
		{
			"key": "record_id",
			"value": "",
			"type": "string"
		},
		{
			"key": "record_creator_id",
			"value": "",
			"type": "string"
		},
		{
			"key": "delegate_info",
			"value": "",
			"type": "string"
		},
		{
			"key": "record_name",
			"value": "",
			"type": "string"
		},
		{
			"key": "delegate_email",
			"value": "delegate@example.com",
			"type": "string"
		},
		{
			"key": "email_verification_token",
			"value": "",
			"type": "string"
		},
		{
			"key": "refresh_token",
			"value": "",
			"type": "string"
		},
		{
			"key": "rec_name",
			"value": "test-record",
			"type": "string"
		},
		{
			"key": "rec_desc",
			"value": "Test record description",
			"type": "string"
		},
		{
			"key": "namespace_desc",
			"value": "Test namespace description",
			"type": "string"
		},
		{
			"key": "ns_name_update",
			"value": "updated-namespace-name",
			"type": "string"
		},
		{
			"key": "ns_desc_update",
			"value": "Updated namespace description",
			"type": "string"
		},
		{
			"key": "reg_desc_update",
			"value": "Updated registry description",
			"type": "string"
		},
		{
			"key": "rec_desc_update",
			"value": "Updated record description",
			"type": "string"
		},
		{
			"key": "domain",
			"value": "example.com",
			"type": "string"
		},
		{
			"key": "search_query",
			"value": "",
			"type": "string"
		},
		{
			"key": "search_page",
			"value": "1",
			"type": "string"
		},
		{
			"key": "search_page_size",
			"value": "10",
			"type": "string"
		},
		{
			"key": "schema_tag",
			"value": "membership",
			"type": "string"
		}
	]
}